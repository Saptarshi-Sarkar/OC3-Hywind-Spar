function [ T ] = FASTTransMat( O1, O2, O3)

O1 = O1 + 1e-15;
O2 = O2 + 1e-15;
O3 = O3 + 1e-15;
n = length(O1);
T = zeros(3,3,n);

for i = 1:n
        
    T1 = (O1(i)^2*sqrt(1+O1(i)^2+O2(i)^2+O3(i)^2)+O2(i)^2+O3(i)^2)/((O1(i)^2+O2(i)^2+O3(i)^2)*sqrt(1+O1(i)^2+O2(i)^2+O3(i)^2));
    T2 = (O3(i)*(O1(i)^2+O2(i)^2+O3(i)^2)+O1(i)*O2(i)*(sqrt(1+O1(i)^2+O2(i)^2+O3(i)^2)-1))/((O1(i)^2+O2(i)^2+O3(i)^2)*sqrt(1+O1(i)^2+O2(i)^2+O3(i)^2));
    T3 = (-O2(i)*(O1(i)^2+O2(i)^2+O3(i)^2)+O1(i)*O3(i)*(sqrt(1+O1(i)^2+O2(i)^2+O3(i)^2)-1))/((O1(i)^2+O2(i)^2+O3(i)^2)*sqrt(1+O1(i)^2+O2(i)^2+O3(i)^2));
    T4 = (-O3(i)*(O1(i)^2+O2(i)^2+O3(i)^2)+O1(i)*O2(i)*(sqrt(1+O1(i)^2+O2(i)^2+O3(i)^2)-1))/((O1(i)^2+O2(i)^2+O3(i)^2)*sqrt(1+O1(i)^2+O2(i)^2+O3(i)^2));
    T5 = (O1(i)^2+O2(i)^2*sqrt(1+O1(i)^2+O2(i)^2+O3(i)^2)+O3(i)^2)/((O1(i)^2+O2(i)^2+O3(i)^2)*sqrt(1+O1(i)^2+O2(i)^2+O3(i)^2));
    T6 = (O1(i)*(O1(i)^2+O2(i)^2+O3(i)^2)+O2(i)*O3(i)*(sqrt(1+O1(i)^2+O2(i)^2+O3(i)^2)-1))/((O1(i)^2+O2(i)^2+O3(i)^2)*sqrt(1+O1(i)^2+O2(i)^2+O3(i)^2));
    T7 = (O2(i)*(O1(i)^2+O2(i)^2+O3(i)^2)+O1(i)*O3(i)*(sqrt(1+O1(i)^2+O2(i)^2+O3(i)^2)-1))/((O1(i)^2+O2(i)^2+O3(i)^2)*sqrt(1+O1(i)^2+O2(i)^2+O3(i)^2));
    T8 = (-O1(i)*(O1(i)^2+O2(i)^2+O3(i)^2)+O2(i)*O3(i)*(sqrt(1+O1(i)^2+O2(i)^2+O3(i)^2)-1))/((O1(i)^2+O2(i)^2+O3(i)^2)*sqrt(1+O1(i)^2+O2(i)^2+O3(i)^2));
    T9 = (O1(i)^2+O2(i)^2+O3(i)^2*sqrt(1+O1(i)^2+O2(i)^2+O3(i)^2))/((O1(i)^2+O2(i)^2+O3(i)^2)*sqrt(1+O1(i)^2+O2(i)^2+O3(i)^2));
    
    T(:,:,i) = [T1, T2, T3;
                T4, T5, T6;
                T7, T8, T9];    
end

end

